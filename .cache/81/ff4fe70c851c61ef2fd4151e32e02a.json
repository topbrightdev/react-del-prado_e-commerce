{"id":"../node_modules/websocket-extensions/lib/websocket_extensions.js","dependencies":[{"name":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/package.json","includedInParent":true,"mtime":1594655165833},{"name":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/node_modules/websocket-extensions/package.json","includedInParent":true,"mtime":1594570878394},{"name":"./parser","loc":{"line":3,"column":23},"parent":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/node_modules/websocket-extensions/lib/websocket_extensions.js","resolved":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/node_modules/websocket-extensions/lib/parser.js"},{"name":"./pipeline","loc":{"line":4,"column":23},"parent":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/node_modules/websocket-extensions/lib/websocket_extensions.js","resolved":"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/template-store1/node_modules/websocket-extensions/lib/pipeline/index.js"}],"generated":{"js":"'use strict';\n\nvar Parser = require('./parser'),\n    Pipeline = require('./pipeline');\n\nvar Extensions = function () {\n  this._rsv1 = this._rsv2 = this._rsv3 = null;\n  this._byName = {};\n  this._inOrder = [];\n  this._sessions = [];\n  this._index = {};\n};\n\nExtensions.MESSAGE_OPCODES = [1, 2];\nvar instance = {\n  add: function (ext) {\n    if (typeof ext.name !== 'string') throw new TypeError('extension.name must be a string');\n    if (ext.type !== 'permessage') throw new TypeError('extension.type must be \"permessage\"');\n    if (typeof ext.rsv1 !== 'boolean') throw new TypeError('extension.rsv1 must be true or false');\n    if (typeof ext.rsv2 !== 'boolean') throw new TypeError('extension.rsv2 must be true or false');\n    if (typeof ext.rsv3 !== 'boolean') throw new TypeError('extension.rsv3 must be true or false');\n    if (this._byName.hasOwnProperty(ext.name)) throw new TypeError('An extension with name \"' + ext.name + '\" is already registered');\n    this._byName[ext.name] = ext;\n\n    this._inOrder.push(ext);\n  },\n  generateOffer: function () {\n    var sessions = [],\n        offer = [],\n        index = {};\n\n    this._inOrder.forEach(function (ext) {\n      var session = ext.createClientSession();\n      if (!session) return;\n      var record = [ext, session];\n      sessions.push(record);\n      index[ext.name] = record;\n      var offers = session.generateOffer();\n      offers = offers ? [].concat(offers) : [];\n      offers.forEach(function (off) {\n        offer.push(Parser.serializeParams(ext.name, off));\n      }, this);\n    }, this);\n\n    this._sessions = sessions;\n    this._index = index;\n    return offer.length > 0 ? offer.join(', ') : null;\n  },\n  activate: function (header) {\n    var responses = Parser.parseHeader(header),\n        sessions = [];\n    responses.eachOffer(function (name, params) {\n      var record = this._index[name];\n      if (!record) throw new Error('Server sent an extension response for unknown extension \"' + name + '\"');\n\n      var ext = record[0],\n          session = record[1],\n          reserved = this._reserved(ext);\n\n      if (reserved) throw new Error('Server sent two extension responses that use the RSV' + reserved[0] + ' bit: \"' + reserved[1] + '\" and \"' + ext.name + '\"');\n      if (session.activate(params) !== true) throw new Error('Server sent unacceptable extension parameters: ' + Parser.serializeParams(name, params));\n\n      this._reserve(ext);\n\n      sessions.push(record);\n    }, this);\n    this._sessions = sessions;\n    this._pipeline = new Pipeline(sessions);\n  },\n  generateResponse: function (header) {\n    var sessions = [],\n        response = [],\n        offers = Parser.parseHeader(header);\n\n    this._inOrder.forEach(function (ext) {\n      var offer = offers.byName(ext.name);\n      if (offer.length === 0 || this._reserved(ext)) return;\n      var session = ext.createServerSession(offer);\n      if (!session) return;\n\n      this._reserve(ext);\n\n      sessions.push([ext, session]);\n      response.push(Parser.serializeParams(ext.name, session.generateResponse()));\n    }, this);\n\n    this._sessions = sessions;\n    this._pipeline = new Pipeline(sessions);\n    return response.length > 0 ? response.join(', ') : null;\n  },\n  validFrameRsv: function (frame) {\n    var allowed = {\n      rsv1: false,\n      rsv2: false,\n      rsv3: false\n    },\n        ext;\n\n    if (Extensions.MESSAGE_OPCODES.indexOf(frame.opcode) >= 0) {\n      for (var i = 0, n = this._sessions.length; i < n; i++) {\n        ext = this._sessions[i][0];\n        allowed.rsv1 = allowed.rsv1 || ext.rsv1;\n        allowed.rsv2 = allowed.rsv2 || ext.rsv2;\n        allowed.rsv3 = allowed.rsv3 || ext.rsv3;\n      }\n    }\n\n    return (allowed.rsv1 || !frame.rsv1) && (allowed.rsv2 || !frame.rsv2) && (allowed.rsv3 || !frame.rsv3);\n  },\n  processIncomingMessage: function (message, callback, context) {\n    this._pipeline.processIncomingMessage(message, callback, context);\n  },\n  processOutgoingMessage: function (message, callback, context) {\n    this._pipeline.processOutgoingMessage(message, callback, context);\n  },\n  close: function (callback, context) {\n    if (!this._pipeline) return callback.call(context);\n\n    this._pipeline.close(callback, context);\n  },\n  _reserve: function (ext) {\n    this._rsv1 = this._rsv1 || ext.rsv1 && ext.name;\n    this._rsv2 = this._rsv2 || ext.rsv2 && ext.name;\n    this._rsv3 = this._rsv3 || ext.rsv3 && ext.name;\n  },\n  _reserved: function (ext) {\n    if (this._rsv1 && ext.rsv1) return [1, this._rsv1];\n    if (this._rsv2 && ext.rsv2) return [2, this._rsv2];\n    if (this._rsv3 && ext.rsv3) return [3, this._rsv3];\n    return false;\n  }\n};\n\nfor (var key in instance) Extensions.prototype[key] = instance[key];\n\nmodule.exports = Extensions;"},"sourceMaps":null,"error":null,"hash":"753114bb391013e23a305c51ff2ab3fb","cacheData":{"env":{}}}