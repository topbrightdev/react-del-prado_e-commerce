{"ast":null,"code":"import _regeneratorRuntime from \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/src/components/checkout/CheckoutForm.jsx\";\nimport React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { placeOrder } from \"../../actions/indexO\";\nimport { CardNumberElement, CardExpiryElement, CardCVCElement, injectStripe } from \"react-stripe-elements\";\nimport axios from \"axios\"; //4242424242424242\n\nvar send = false;\nvar email,\n    total,\n    amount = null;\nvar port = process.env.PORT || 7000;\nvar urlCharge = process.env.NODE_ENV.trim() === \"production\" ? \"https://waldenberginc.com/api/stripe/charge\" : \"http://localhost:7000/api/stripe/charge\"; //const urlCharge ='http://waldenberginc.com/api/stripe/charge'\n\nvar newTo = function newTo(receiptUrl) {\n  return {\n    pathname: \"\".concat(process.env.PUBLIC_URL, \"/order-success\"),\n    receiptUrl: receiptUrl\n  };\n};\n\nvar CheckoutForm = function CheckoutForm(_ref) {\n  var selectedProduct = _ref.selectedProduct,\n      stripe = _ref.stripe,\n      history = _ref.history,\n      total = _ref.total,\n      email = _ref.email,\n      data = _ref.data;\n  if (selectedProduct === null) history.push(\"/\"); //onst [receiptUrl, setReceiptUrl] = useState(\"\");\n\n  var orderData = \"\";\n  console.log(data);\n\n  var createOrderData = function createOrderData() {\n    console.log(data);\n    orderData = {\n      username: data.username,\n      email: data.email,\n      // password : this.state.password,\n      address_1: data.address_1,\n      city: data.city,\n      country: data.country,\n      first_name: data.first_name,\n      last_name: data.last_name,\n      phone: data.phone,\n      postcode: data.postcode,\n      state: data.state,\n      cart: data.cart,\n      total: data.total\n    };\n    return orderData;\n  };\n\n  var handleSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(event) {\n      var amount, _ref3, error, token, order, receiptUrl;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              console.log(total);\n              amount = total * 100;\n              amount = amount.toString();\n              console.log(amount);\n              _context.next = 7;\n              return stripe.createToken();\n\n            case 7:\n              _ref3 = _context.sent;\n              error = _ref3.error;\n              token = _ref3.token;\n\n              if (error) {\n                console.log(error);\n              }\n\n              if (token) {\n                console.log(token);\n              }\n\n              _context.next = 14;\n              return axios.post(\"http://localhost:9000/stripe\", {\n                amount: amount,\n                source: token.id,\n                receipt_email: email\n              }).catch(function (e) {\n                console.log(e);\n              });\n\n            case 14:\n              order = _context.sent;\n              createOrderData();\n              receiptUrl = \"\";\n              console.log(order.data);\n              console.log(orderData);\n              receiptUrl = order.data.charge.receipt_url; //history.push(`${process.env.PUBLIC_URL}/order-success`);\n\n              props.placeOrder(orderData);\n              history.push(newTo(receiptUrl)); // receiptUrl = order.data.charge.receipt_url;\n              //receiveReceipt(receiptUrl);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // if (receiptUrl) {\n  // if (receiptUrl) {\n  //  history.push(\n  //   `${process.env.PUBLIC_URL}/order-success`\n  //  );\n\n  /*const newTo = (receipt) => {\n    return {\n      pathname: `${process.env.PUBLIC_URL}/order-success`,\n      receipt: receipt,\n    };\n  };\n  */\n  // if (receiptUrl) {\n\n\n  return React.createElement(\"div\", {\n    className: \"checkout-details\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"checkout-form farm-19\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, React.createElement(\"h6\", {\n    className: \"checkout-text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, \"Introduce your Credit Card Information\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Amount: \", total, \" $ \"), React.createElement(\"div\", {\n    className: \"checkout-number\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"checkout-label-number\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, \"Card details\", React.createElement(CardNumberElement, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"checkout-card-details\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    className: \"checkout-label\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, \"Expiration date\", React.createElement(CardExpiryElement, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  })), React.createElement(\"label\", {\n    className: \"checkout-label cvc\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"CVC\", React.createElement(CardCVCElement, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    className: \"checkout-div-button\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn-solid btn\",\n    onClick: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, \"Pay\")));\n}; //export default injectStripe(CheckoutForm);\n\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state\n  };\n};\n\nexport default connect(mapStateToProps, {\n  placeOrder: placeOrder\n})(injectStripe(CheckoutForm));","map":{"version":3,"sources":["/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/src/components/checkout/CheckoutForm.jsx"],"names":["React","useState","connect","placeOrder","CardNumberElement","CardExpiryElement","CardCVCElement","injectStripe","axios","send","email","total","amount","port","process","env","PORT","urlCharge","NODE_ENV","trim","newTo","receiptUrl","pathname","PUBLIC_URL","CheckoutForm","selectedProduct","stripe","history","data","push","orderData","console","log","createOrderData","username","address_1","city","country","first_name","last_name","phone","postcode","state","cart","handleSubmit","event","preventDefault","toString","createToken","error","token","post","source","id","receipt_email","catch","e","order","charge","receipt_url","props","mapStateToProps"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,UAAT,QAA2B,sBAA3B;AACA,SACEC,iBADF,EAEEC,iBAFF,EAGEC,cAHF,EAIEC,YAJF,QAKO,uBALP;AAMA,OAAOC,KAAP,MAAkB,OAAlB,C,CAEA;;AAEA,IAAIC,IAAI,GAAG,KAAX;AACA,IAAIC,KAAJ;AAAA,IACEC,KADF;AAAA,IAEEC,MAAM,GAAG,IAFX;AAIA,IAAMC,IAAI,GAAGC,OAAO,CAACC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;AAEA,IAAMC,SAAS,GACbH,OAAO,CAACC,GAAR,CAAYG,QAAZ,CAAqBC,IAArB,OAAgC,YAAhC,mDAEI,yCAHN,C,CAIA;;AAEA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,UAAD,EAAgB;AAC5B,SAAO;AACLC,IAAAA,QAAQ,YAAKR,OAAO,CAACC,GAAR,CAAYQ,UAAjB,mBADH;AAELF,IAAAA,UAAU,EAAEA;AAFP,GAAP;AAID,CALD;;AAOA,IAAMG,YAAY,GAAG,SAAfA,YAAe,OAOf;AAAA,MANJC,eAMI,QANJA,eAMI;AAAA,MALJC,MAKI,QALJA,MAKI;AAAA,MAJJC,OAII,QAJJA,OAII;AAAA,MAHJhB,KAGI,QAHJA,KAGI;AAAA,MAFJD,KAEI,QAFJA,KAEI;AAAA,MADJkB,IACI,QADJA,IACI;AACJ,MAAIH,eAAe,KAAK,IAAxB,EAA8BE,OAAO,CAACE,IAAR,CAAa,GAAb,EAD1B,CAEJ;;AAEA,MAAIC,SAAS,GAAG,EAAhB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAZ;;AACA,MAAMK,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAC5BF,IAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAZ;AACAE,IAAAA,SAAS,GAAG;AACVI,MAAAA,QAAQ,EAAEN,IAAI,CAACM,QADL;AAEVxB,MAAAA,KAAK,EAAEkB,IAAI,CAAClB,KAFF;AAGV;AACAyB,MAAAA,SAAS,EAAEP,IAAI,CAACO,SAJN;AAKVC,MAAAA,IAAI,EAAER,IAAI,CAACQ,IALD;AAMVC,MAAAA,OAAO,EAAET,IAAI,CAACS,OANJ;AAOVC,MAAAA,UAAU,EAAEV,IAAI,CAACU,UAPP;AAQVC,MAAAA,SAAS,EAAEX,IAAI,CAACW,SARN;AASVC,MAAAA,KAAK,EAAEZ,IAAI,CAACY,KATF;AAUVC,MAAAA,QAAQ,EAAEb,IAAI,CAACa,QAVL;AAWVC,MAAAA,KAAK,EAAEd,IAAI,CAACc,KAXF;AAYVC,MAAAA,IAAI,EAAEf,IAAI,CAACe,IAZD;AAaVhC,MAAAA,KAAK,EAAEiB,IAAI,CAACjB;AAbF,KAAZ;AAeA,WAAOmB,SAAP;AACD,GAlBD;;AAoBA,MAAMc,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAG,iBAAOC,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnBA,cAAAA,KAAK,CAACC,cAAN;AACAf,cAAAA,OAAO,CAACC,GAAR,CAAYrB,KAAZ;AACIC,cAAAA,MAHe,GAGND,KAAK,GAAG,GAHF;AAInBC,cAAAA,MAAM,GAAGA,MAAM,CAACmC,QAAP,EAAT;AACAhB,cAAAA,OAAO,CAACC,GAAR,CAAYpB,MAAZ;AALmB;AAAA,qBAMYc,MAAM,CAACsB,WAAP,EANZ;;AAAA;AAAA;AAMXC,cAAAA,KANW,SAMXA,KANW;AAMJC,cAAAA,KANI,SAMJA,KANI;;AAOnB,kBAAID,KAAJ,EAAW;AACTlB,gBAAAA,OAAO,CAACC,GAAR,CAAYiB,KAAZ;AACD;;AACD,kBAAIC,KAAJ,EAAW;AACTnB,gBAAAA,OAAO,CAACC,GAAR,CAAYkB,KAAZ;AACD;;AAZkB;AAAA,qBAaC1C,KAAK,CACtB2C,IADiB,CACZ,8BADY,EACoB;AACpCvC,gBAAAA,MAAM,EAAEA,MAD4B;AAEpCwC,gBAAAA,MAAM,EAAEF,KAAK,CAACG,EAFsB;AAGpCC,gBAAAA,aAAa,EAAE5C;AAHqB,eADpB,EAMjB6C,KANiB,CAMX,UAACC,CAAD,EAAO;AACZzB,gBAAAA,OAAO,CAACC,GAAR,CAAYwB,CAAZ;AACD,eARiB,CAbD;;AAAA;AAabC,cAAAA,KAba;AAsBnBxB,cAAAA,eAAe;AACXZ,cAAAA,UAvBe,GAuBF,EAvBE;AAwBnBU,cAAAA,OAAO,CAACC,GAAR,CAAYyB,KAAK,CAAC7B,IAAlB;AACAG,cAAAA,OAAO,CAACC,GAAR,CAAYF,SAAZ;AACAT,cAAAA,UAAU,GAAGoC,KAAK,CAAC7B,IAAN,CAAW8B,MAAX,CAAkBC,WAA/B,CA1BmB,CA2BnB;;AACAC,cAAAA,KAAK,CAACzD,UAAN,CAAiB2B,SAAjB;AACAH,cAAAA,OAAO,CAACE,IAAR,CAAaT,KAAK,CAACC,UAAD,CAAlB,EA7BmB,CA+BnB;AACA;;AAhCmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZuB,YAAY;AAAA;AAAA;AAAA,KAAlB,CA1BI,CA6DJ;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AAOA;;;AAEA,SACE;AAAK,IAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAI,IAAA,SAAS,EAAC,eAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CADF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAYjC,KAAZ,QAJF,EAME;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,SAAS,EAAC,uBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEE,oBAAC,iBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,CANF,EAYE;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,SAAS,EAAC,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAEE,oBAAC,iBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,EAME;AAAO,IAAA,SAAS,EAAC,oBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAEE,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CANF,CAZF,CADF,EAyBE;AAAK,IAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAQ,IAAA,IAAI,EAAC,QAAb;AAAsB,IAAA,SAAS,EAAC,eAAhC;AAAgD,IAAA,OAAO,EAAEiC,YAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WADF,CAzBF,CADF;AAiCD,CApHD,C,CAsHA;;;AACA,IAAMiB,eAAe,GAAG,SAAlBA,eAAkB,CAACnB,KAAD;AAAA,SAAY;AAClCA,IAAAA,KAAK,EAALA;AADkC,GAAZ;AAAA,CAAxB;;AAIA,eAAexC,OAAO,CACpB2D,eADoB,EAEpB;AAAE1D,EAAAA,UAAU,EAAVA;AAAF,CAFoB,CAAP,CAGbI,YAAY,CAACiB,YAAD,CAHC,CAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { placeOrder } from \"../../actions/indexO\";\nimport {\n  CardNumberElement,\n  CardExpiryElement,\n  CardCVCElement,\n  injectStripe,\n} from \"react-stripe-elements\";\nimport axios from \"axios\";\n\n//4242424242424242\n\nvar send = false;\nvar email,\n  total,\n  amount = null;\n\nconst port = process.env.PORT || 7000;\n\nconst urlCharge =\n  process.env.NODE_ENV.trim() === \"production\"\n    ? `https://waldenberginc.com/api/stripe/charge`\n    : \"http://localhost:7000/api/stripe/charge\";\n//const urlCharge ='http://waldenberginc.com/api/stripe/charge'\n\nconst newTo = (receiptUrl) => {\n  return {\n    pathname: `${process.env.PUBLIC_URL}/order-success`,\n    receiptUrl: receiptUrl,\n  };\n};\n\nconst CheckoutForm = ({\n  selectedProduct,\n  stripe,\n  history,\n  total,\n  email,\n  data,\n}) => {\n  if (selectedProduct === null) history.push(\"/\");\n  //onst [receiptUrl, setReceiptUrl] = useState(\"\");\n\n  var orderData = \"\";\n  console.log(data);\n  const createOrderData = () => {\n    console.log(data);\n    orderData = {\n      username: data.username,\n      email: data.email,\n      // password : this.state.password,\n      address_1: data.address_1,\n      city: data.city,\n      country: data.country,\n      first_name: data.first_name,\n      last_name: data.last_name,\n      phone: data.phone,\n      postcode: data.postcode,\n      state: data.state,\n      cart: data.cart,\n      total: data.total,\n    };\n    return orderData;\n  };\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    console.log(total);\n    var amount = total * 100;\n    amount = amount.toString();\n    console.log(amount);\n    const { error, token } = await stripe.createToken();\n    if (error) {\n      console.log(error);\n    }\n    if (token) {\n      console.log(token);\n    }\n    const order = await axios\n      .post(\"http://localhost:9000/stripe\", {\n        amount: amount,\n        source: token.id,\n        receipt_email: email,\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n    createOrderData();\n    var receiptUrl = \"\";\n    console.log(order.data);\n    console.log(orderData);\n    receiptUrl = order.data.charge.receipt_url;\n    //history.push(`${process.env.PUBLIC_URL}/order-success`);\n    props.placeOrder(orderData);\n    history.push(newTo(receiptUrl));\n\n    // receiptUrl = order.data.charge.receipt_url;\n    //receiveReceipt(receiptUrl);\n  };\n\n  // if (receiptUrl) {\n  // if (receiptUrl) {\n  //  history.push(\n  //   `${process.env.PUBLIC_URL}/order-success`\n  //  );\n\n  /*const newTo = (receipt) => {\n    return {\n      pathname: `${process.env.PUBLIC_URL}/order-success`,\n      receipt: receipt,\n    };\n  };\n*/\n  // if (receiptUrl) {\n\n  return (\n    <div className=\"checkout-details\">\n      <div className=\"checkout-form farm-19\">\n        <h6 className=\"checkout-text\">\n          Introduce your Credit Card Information\n        </h6>\n        <p>Amount: {total} $ </p>\n\n        <div className=\"checkout-number\">\n          <label className=\"checkout-label-number\">\n            Card details\n            <CardNumberElement />\n          </label>\n        </div>\n        <div className=\"checkout-card-details\">\n          <label className=\"checkout-label\">\n            Expiration date\n            <CardExpiryElement />\n          </label>\n\n          <label className=\"checkout-label cvc\">\n            CVC\n            <CardCVCElement />\n          </label>\n        </div>\n      </div>\n      <div className=\"checkout-div-button\">\n        <button type=\"button\" className=\"btn-solid btn\" onClick={handleSubmit}>\n          Pay\n        </button>\n      </div>\n    </div>\n  );\n};\n\n//export default injectStripe(CheckoutForm);\nconst mapStateToProps = (state) => ({\n  state,\n});\n\nexport default connect(\n  mapStateToProps,\n  { placeOrder }\n)(injectStripe(CheckoutForm));\n"]},"metadata":{},"sourceType":"module"}