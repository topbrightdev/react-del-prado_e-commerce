{"ast":null,"code":"import _regeneratorRuntime from \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/src/components/checkout/CheckoutForm.jsx\";\n\nimport React from \"react\";\nimport { useState } from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\n\nvar CheckoutForm = function CheckoutForm(_ref) {\n  var price = _ref.price,\n      onSuccessfulCheckout = _ref.onSuccessfulCheckout;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isProcessing = _useState2[0],\n      setProcessingTo = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      checkoutError = _useState4[0],\n      setCheckoutError = _useState4[1];\n\n  var stripe = useStripe();\n  var elements = useElements(); // TIP\n  // use the cardElements onChange prop to add a handler\n  // for setting any errors:\n\n  var handleCardDetailsChange = function handleCardDetailsChange(ev) {\n    ev.error ? setCheckoutError(ev.error.message) : setCheckoutError();\n  };\n\n  var handleFormSubmit =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(ev) {\n      var billingDetails, callAPI, cardElement, _ref4, clientSecret, paymentMethodReq, _ref5, error;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              ev.preventDefault();\n              billingDetails = {\n                name: \"juan\",\n                email: \"as@as.com\",\n                address: {\n                  city: \"moreda\",\n                  line1: \"yes\",\n                  state: \"of mind\",\n                  postal_code: \"33500\"\n                }\n              };\n              setProcessingTo(true);\n\n              callAPI =\n              /*#__PURE__*/\n              function () {\n                var _ref3 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee() {\n                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return fetch(\"http://localhost:9000/testAPI\").then(function (res) {\n                            res.text();\n                          }).then(function (res) {\n                            return _this.setState({\n                              apiResponse: res\n                            });\n                          });\n\n                        case 2:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee, this);\n                }));\n\n                return function callAPI() {\n                  return _ref3.apply(this, arguments);\n                };\n              }();\n\n              cardElement = elements.getElement(\"card\");\n              _context2.prev = 5;\n              _context2.next = 8;\n              return axios.post(\"../../api/payment_intents\", {\n                amount: price * 100\n              });\n\n            case 8:\n              _ref4 = _context2.sent;\n              clientSecret = _ref4.data;\n              _context2.next = 12;\n              return stripe.createPaymentMethod({\n                type: \"card\",\n                card: cardElement,\n                billing_details: billingDetails\n              });\n\n            case 12:\n              paymentMethodReq = _context2.sent;\n\n              if (!paymentMethodReq.error) {\n                _context2.next = 17;\n                break;\n              }\n\n              setCheckoutError(paymentMethodReq.error.message);\n              setProcessingTo(false);\n              return _context2.abrupt(\"return\");\n\n            case 17:\n              _context2.next = 19;\n              return stripe.confirmCardPayment(clientSecret, {\n                payment_method: paymentMethodReq.paymentMethod.id\n              });\n\n            case 19:\n              _ref5 = _context2.sent;\n              error = _ref5.error;\n\n              if (!error) {\n                _context2.next = 25;\n                break;\n              }\n\n              setCheckoutError(error.message);\n              setProcessingTo(false);\n              return _context2.abrupt(\"return\");\n\n            case 25:\n              onSuccessfulCheckout();\n              _context2.next = 31;\n              break;\n\n            case 28:\n              _context2.prev = 28;\n              _context2.t0 = _context2[\"catch\"](5);\n              setCheckoutError(_context2.t0.message);\n\n            case 31:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[5, 28]]);\n    }));\n\n    return function handleFormSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // Learning\n  // A common ask/bug that users run into is:\n  // How do you change the color of the card element input text?\n  // How do you change the font-size of the card element input text?\n  // How do you change the placeholder color?\n  // The answer to all of the above is to use the `style` option.\n  // It's common to hear users confused why the card element appears impervious\n  // to all their styles. No matter what classes they add to the parent element\n  // nothing within the card element seems to change. The reason for this is that\n  // the card element is housed within an iframe and:\n  // > styles do not cascade from a parent window down into its iframes\n\n\n  var iframeStyles = {\n    base: {\n      color: \"#fff\",\n      fontSize: \"16px\",\n      iconColor: \"#fff\",\n      \"::placeholder\": {\n        color: \"#87bbfd\"\n      }\n    },\n    invalid: {\n      iconColor: \"#FFC7EE\",\n      color: \"#FFC7EE\"\n    },\n    complete: {\n      iconColor: \"#cbf4c9\"\n    }\n  };\n  var cardElementOpts = {\n    iconStyle: \"solid\",\n    style: iframeStyles,\n    hidePostalCode: true\n  };\n  return React.createElement(\"form\", {\n    onSubmit: handleFormSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, React.createElement(CardElement, {\n    onChange: handleCardDetailsChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    disabled: isProcessing || !stripe,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, isProcessing ? \"Processing...\" : \"Pay $\".concat(price)));\n};\n\nexport default CheckoutForm;","map":{"version":3,"sources":["/home/jarri/Desktop/lenovo2020/projects-web/eCommerce/store/frontEnd/src/components/checkout/CheckoutForm.jsx"],"names":["React","useState","CardElement","useStripe","useElements","axios","CheckoutForm","price","onSuccessfulCheckout","isProcessing","setProcessingTo","checkoutError","setCheckoutError","stripe","elements","handleCardDetailsChange","ev","error","message","handleFormSubmit","preventDefault","billingDetails","name","email","address","city","line1","state","postal_code","callAPI","fetch","then","res","text","setState","apiResponse","cardElement","getElement","post","amount","clientSecret","data","createPaymentMethod","type","card","billing_details","paymentMethodReq","confirmCardPayment","payment_method","paymentMethod","id","iframeStyles","base","color","fontSize","iconColor","invalid","complete","cardElementOpts","iconStyle","style","hidePostalCode"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,SAASC,WAAT,EAAsBC,SAAtB,EAAiCC,WAAjC,QAAoD,yBAApD;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,OAAqC;AAAA,MAAlCC,KAAkC,QAAlCA,KAAkC;AAAA,MAA3BC,oBAA2B,QAA3BA,oBAA2B;;AAAA,kBAChBP,QAAQ,CAAC,KAAD,CADQ;AAAA;AAAA,MACjDQ,YADiD;AAAA,MACnCC,eADmC;;AAAA,mBAEdT,QAAQ,EAFM;AAAA;AAAA,MAEjDU,aAFiD;AAAA,MAElCC,gBAFkC;;AAIxD,MAAMC,MAAM,GAAGV,SAAS,EAAxB;AACA,MAAMW,QAAQ,GAAGV,WAAW,EAA5B,CALwD,CAOxD;AACA;AACA;;AAEA,MAAMW,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACC,EAAD,EAAQ;AACtCA,IAAAA,EAAE,CAACC,KAAH,GAAWL,gBAAgB,CAACI,EAAE,CAACC,KAAH,CAASC,OAAV,CAA3B,GAAgDN,gBAAgB,EAAhE;AACD,GAFD;;AAIA,MAAMO,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAG,kBAAOH,EAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACvBA,cAAAA,EAAE,CAACI,cAAH;AAEMC,cAAAA,cAHiB,GAGA;AACrBC,gBAAAA,IAAI,EAAE,MADe;AAErBC,gBAAAA,KAAK,EAAE,WAFc;AAGrBC,gBAAAA,OAAO,EAAE;AACPC,kBAAAA,IAAI,EAAE,QADC;AAEPC,kBAAAA,KAAK,EAAE,KAFA;AAGPC,kBAAAA,KAAK,EAAE,SAHA;AAIPC,kBAAAA,WAAW,EAAE;AAJN;AAHY,eAHA;AAcvBlB,cAAAA,eAAe,CAAC,IAAD,CAAf;;AAEMmB,cAAAA,OAhBiB;AAAA;AAAA;AAAA;AAAA;AAAA,yCAgBP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCACRC,KAAK,CAAC,+BAAD,CAAL,CACHC,IADG,CACE,UAACC,GAAD,EAAS;AACbA,4BAAAA,GAAG,CAACC,IAAJ;AACD,2BAHG,EAIHF,IAJG,CAIE,UAACC,GAAD;AAAA,mCAAS,KAAI,CAACE,QAAL,CAAc;AAAEC,8BAAAA,WAAW,EAAEH;AAAf,6BAAd,CAAT;AAAA,2BAJF,CADQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAhBO;;AAAA,gCAgBjBH,OAhBiB;AAAA;AAAA;AAAA;;AAuBjBO,cAAAA,WAvBiB,GAuBHtB,QAAQ,CAACuB,UAAT,CAAoB,MAApB,CAvBG;AAAA;AAAA;AAAA,qBA0BgBhC,KAAK,CAACiC,IAAN,CACnC,2BADmC,EAEnC;AACEC,gBAAAA,MAAM,EAAEhC,KAAK,GAAG;AADlB,eAFmC,CA1BhB;;AAAA;AAAA;AA0BPiC,cAAAA,YA1BO,SA0BbC,IA1Ba;AAAA;AAAA,qBAiCU5B,MAAM,CAAC6B,mBAAP,CAA2B;AACxDC,gBAAAA,IAAI,EAAE,MADkD;AAExDC,gBAAAA,IAAI,EAAER,WAFkD;AAGxDS,gBAAAA,eAAe,EAAExB;AAHuC,eAA3B,CAjCV;;AAAA;AAiCfyB,cAAAA,gBAjCe;;AAAA,mBAuCjBA,gBAAgB,CAAC7B,KAvCA;AAAA;AAAA;AAAA;;AAwCnBL,cAAAA,gBAAgB,CAACkC,gBAAgB,CAAC7B,KAAjB,CAAuBC,OAAxB,CAAhB;AACAR,cAAAA,eAAe,CAAC,KAAD,CAAf;AAzCmB;;AAAA;AAAA;AAAA,qBA6CGG,MAAM,CAACkC,kBAAP,CAA0BP,YAA1B,EAAwC;AAC9DQ,gBAAAA,cAAc,EAAEF,gBAAgB,CAACG,aAAjB,CAA+BC;AADe,eAAxC,CA7CH;;AAAA;AAAA;AA6CbjC,cAAAA,KA7Ca,SA6CbA,KA7Ca;;AAAA,mBAiDjBA,KAjDiB;AAAA;AAAA;AAAA;;AAkDnBL,cAAAA,gBAAgB,CAACK,KAAK,CAACC,OAAP,CAAhB;AACAR,cAAAA,eAAe,CAAC,KAAD,CAAf;AAnDmB;;AAAA;AAuDrBF,cAAAA,oBAAoB;AAvDC;AAAA;;AAAA;AAAA;AAAA;AAyDrBI,cAAAA,gBAAgB,CAAC,aAAIM,OAAL,CAAhB;;AAzDqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAhBC,gBAAgB;AAAA;AAAA;AAAA,KAAtB,CAfwD,CA4ExD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,MAAMgC,YAAY,GAAG;AACnBC,IAAAA,IAAI,EAAE;AACJC,MAAAA,KAAK,EAAE,MADH;AAEJC,MAAAA,QAAQ,EAAE,MAFN;AAGJC,MAAAA,SAAS,EAAE,MAHP;AAIJ,uBAAiB;AACfF,QAAAA,KAAK,EAAE;AADQ;AAJb,KADa;AASnBG,IAAAA,OAAO,EAAE;AACPD,MAAAA,SAAS,EAAE,SADJ;AAEPF,MAAAA,KAAK,EAAE;AAFA,KATU;AAanBI,IAAAA,QAAQ,EAAE;AACRF,MAAAA,SAAS,EAAE;AADH;AAbS,GAArB;AAkBA,MAAMG,eAAe,GAAG;AACtBC,IAAAA,SAAS,EAAE,OADW;AAEtBC,IAAAA,KAAK,EAAET,YAFe;AAGtBU,IAAAA,cAAc,EAAE;AAHM,GAAxB;AAMA,SACE;AAAM,IAAA,QAAQ,EAAE1C,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,WAAD;AAAa,IAAA,QAAQ,EAAEJ,uBAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAIE;AAAQ,IAAA,QAAQ,EAAEN,YAAY,IAAI,CAACI,MAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGJ,YAAY,GAAG,eAAH,kBAA6BF,KAA7B,CADf,CAJF,CADF;AAUD,CA1HD;;AA4HA,eAAeD,YAAf","sourcesContent":["import React from \"react\";\nimport { useState } from \"react\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport axios from \"axios\";\n\nconst CheckoutForm = ({ price, onSuccessfulCheckout }) => {\n  const [isProcessing, setProcessingTo] = useState(false);\n  const [checkoutError, setCheckoutError] = useState();\n\n  const stripe = useStripe();\n  const elements = useElements();\n\n  // TIP\n  // use the cardElements onChange prop to add a handler\n  // for setting any errors:\n\n  const handleCardDetailsChange = (ev) => {\n    ev.error ? setCheckoutError(ev.error.message) : setCheckoutError();\n  };\n\n  const handleFormSubmit = async (ev) => {\n    ev.preventDefault();\n\n    const billingDetails = {\n      name: \"juan\",\n      email: \"as@as.com\",\n      address: {\n        city: \"moreda\",\n        line1: \"yes\",\n        state: \"of mind\",\n        postal_code: \"33500\",\n      },\n    };\n\n    setProcessingTo(true);\n\n    const callAPI = async () => {\n      await fetch(\"http://localhost:9000/testAPI\")\n        .then((res) => {\n          res.text();\n        })\n        .then((res) => this.setState({ apiResponse: res }));\n    };\n    const cardElement = elements.getElement(\"card\");\n\n    try {\n      const { data: clientSecret } = await axios.post(\n        \"../../api/payment_intents\",\n        {\n          amount: price * 100,\n        }\n      );\n\n      const paymentMethodReq = await stripe.createPaymentMethod({\n        type: \"card\",\n        card: cardElement,\n        billing_details: billingDetails,\n      });\n\n      if (paymentMethodReq.error) {\n        setCheckoutError(paymentMethodReq.error.message);\n        setProcessingTo(false);\n        return;\n      }\n\n      const { error } = await stripe.confirmCardPayment(clientSecret, {\n        payment_method: paymentMethodReq.paymentMethod.id,\n      });\n\n      if (error) {\n        setCheckoutError(error.message);\n        setProcessingTo(false);\n        return;\n      }\n\n      onSuccessfulCheckout();\n    } catch (err) {\n      setCheckoutError(err.message);\n    }\n  };\n\n  // Learning\n  // A common ask/bug that users run into is:\n  // How do you change the color of the card element input text?\n  // How do you change the font-size of the card element input text?\n  // How do you change the placeholder color?\n  // The answer to all of the above is to use the `style` option.\n  // It's common to hear users confused why the card element appears impervious\n  // to all their styles. No matter what classes they add to the parent element\n  // nothing within the card element seems to change. The reason for this is that\n  // the card element is housed within an iframe and:\n  // > styles do not cascade from a parent window down into its iframes\n\n  const iframeStyles = {\n    base: {\n      color: \"#fff\",\n      fontSize: \"16px\",\n      iconColor: \"#fff\",\n      \"::placeholder\": {\n        color: \"#87bbfd\",\n      },\n    },\n    invalid: {\n      iconColor: \"#FFC7EE\",\n      color: \"#FFC7EE\",\n    },\n    complete: {\n      iconColor: \"#cbf4c9\",\n    },\n  };\n\n  const cardElementOpts = {\n    iconStyle: \"solid\",\n    style: iframeStyles,\n    hidePostalCode: true,\n  };\n\n  return (\n    <form onSubmit={handleFormSubmit}>\n      <CardElement onChange={handleCardDetailsChange} />\n\n      {/* TIP always disable your submit button while processing payments */}\n      <button disabled={isProcessing || !stripe}>\n        {isProcessing ? \"Processing...\" : `Pay $${price}`}\n      </button>\n    </form>\n  );\n};\n\nexport default CheckoutForm;\n"]},"metadata":{},"sourceType":"module"}